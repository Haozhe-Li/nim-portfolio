# AI-Content-Classifier 项目架构与核心概念

项目链接：[zeroai.haozheli.com](https://zeroai.haozheli.com)

本项目旨在通过机器学习与自然语言处理技术，判断输入文本是 AI 生成还是人类创作。下文将介绍项目的整体架构、各模块功能及核心流程。

## 核心模块说明

### 1. `core/classifier.py`
- **AIContentClassifier**：主分类器类，集成了 GPT2 语言模型与自定义机器学习模型。
    - `get_ppl`：计算文本困惑度（Perplexity），衡量文本的自然性。
    - `get_pplx_map`：对分句后的文本逐句计算困惑度，统计 burstiness（最大困惑度）与平均困惑度。
    - `get_likelihood`：基于困惑度特征，调用随机森林模型预测 AI 生成概率。
    - `classify`：主入口，综合上述方法输出最终判定与可视化结果。

### 2. `core/model/`
- **load_model.py**：负责加载训练好的机器学习模型（如随机森林）。
- **ml_model.pkl**：保存的模型权重文件。

### 3. `core/utils.py`
- 文本清洗、分句、结果渲染等辅助函数。

### 4. 前端与交互
- **index.html** + **assets/**：用户输入文本，前端通过 API 与后端交互，展示检测结果。

## 核心流程

1. **文本输入**：用户提交待检测文本。
2. **文本预处理**：清洗与分句，保证输入有效性。
3. **困惑度计算**：利用 GPT2 计算每句文本的困惑度。
4. **特征提取**：统计平均困惑度、最大困惑度、分句数、连续低困惑度片段等特征。
5. **机器学习判别**：将特征输入随机森林模型，输出 AI 生成概率。
6. **结果展示**：返回判定标签、概率分数及可视化报告。

## PPLx 计算方法详解

PPLx（分句困惑度映射）是本项目用于分析文本局部自然性的重要特征。其计算流程如下：

1. **文本分句**：首先将输入文本按句子进行分割，确保每个片段语义完整。
2. **逐句困惑度计算**：对每个句子，利用 GPT2 语言模型分别计算其困惑度（Perplexity, PPL）。
3. **统计特征提取**：
    - 记录每句的困惑度，形成困惑度序列（PPLx Map）。
    - 计算所有句子的平均困惑度（mean PPL）。
    - 计算最大困惑度（burstiness），反映文本中最不自然的片段。
    - 可进一步统计连续低困惑度片段等特征。
4. **可视化与判别**：
    - PPLx Map 可用于可视化展示，帮助理解文本各部分的自然性分布。
    - 这些特征作为机器学习模型的输入，用于最终的 AI 内容判别。

**示例伪代码：**

```python
sentences = split_sentences(text)
pplx_map = [get_ppl(sentence) for sentence in sentences]
mean_ppl = np.mean(pplx_map)
burstiness = np.max(pplx_map)
```

PPLx 的引入，使得模型不仅关注整体困惑度，还能捕捉文本内部的异常波动，从而提升 AI 内容检测的准确性。

## 关键概念

- **困惑度（Perplexity, PPL）**：衡量语言模型对文本的“困惑”程度，数值越低表示文本越自然。
- **Burstiness**：文本中最大困惑度，反映局部异常性。
- **随机森林（Random Forest）**：集成多棵决策树的机器学习模型，用于最终分类。

## 适用场景
- 检测学术论文、文章、社交媒体内容是否为 AI 生成。
- 作为内容审核、学术诚信等场景的辅助工具。
